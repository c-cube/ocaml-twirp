<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Twirp_tiny_httpd (twirp_tiny_httpd.Twirp_tiny_httpd)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta name="generator" content="odoc 2.4.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../index.html">twirp_tiny_httpd</a> &#x00BB; Twirp_tiny_httpd</nav><header class="odoc-preamble"><h1>Module <code><span>Twirp_tiny_httpd</span></code></h1><p>Twirp for tiny_httpd.</p><p>This implements the server end of https://github.com/twitchtv/twirp</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec module anchored" id="module-Error"><a href="#module-Error" class="anchor"></a><code><span><span class="keyword">module</span> Error</span><span> = <a href="../../twirp_core/Twirp_core/Error/index.html">Twirp_core.Error</a></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Error_codes"><a href="#module-Error_codes" class="anchor"></a><code><span><span class="keyword">module</span> Error_codes</span><span> = <a href="../../twirp_core/Twirp_core/Error_codes/index.html">Twirp_core.Error_codes</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-fail"><a href="#val-fail" class="anchor"></a><code><span><span class="keyword">val</span> fail : <span><span class="optlabel">?msg</span>:string <span class="arrow">&#45;&gt;</span></span> <span><a href="../../twirp_core/Twirp_core/Error_codes/index.html#type-t">Error_codes.t</a> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-failf"><a href="#val-failf" class="anchor"></a><code><span><span class="keyword">val</span> failf : 
  <span><a href="../../twirp_core/Twirp_core/Error_codes/index.html#type-t">Error_codes.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'a</span>, <a href="../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a>, unit, <span class="type-var">'b</span>)</span> <a href="../../ocaml/Stdlib/index.html#type-format4">format4</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'a</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-handler"><a href="#type-handler" class="anchor"></a><code><span><span class="keyword">type</span> handler</span><span> = </span></code><ol><li id="type-handler.Handler" class="def variant constructor anchored"><a href="#type-handler.Handler" class="anchor"></a><code><span>| </span><span><span class="constructor">Handler</span> : </span><span>{</span></code><ol><li id="type-handler.rpc" class="def record field anchored"><a href="#type-handler.rpc" class="anchor"></a><code><span>rpc : <span><span>(<span class="type-var">'req</span>,
        <a href="../../pbrt_services/Pbrt_services/Value_mode/index.html#type-unary">Pbrt_services.Value_mode.unary</a>,
        <span class="type-var">'res</span>,
        <a href="../../pbrt_services/Pbrt_services/Value_mode/index.html#type-unary">Pbrt_services.Value_mode.unary</a>)</span>
        <a href="../../pbrt_services/Pbrt_services/Server/index.html#type-rpc">Pbrt_services.Server.rpc</a></span>;</span></code></li><li id="type-handler.f" class="def record field anchored"><a href="#type-handler.f" class="anchor"></a><code><span>f : <span><span class="type-var">'req</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'res</span>;</span></code></li></ol><code><span>}</span><span> <span class="arrow">&#45;&gt;</span> <a href="#type-handler">handler</a></span></code></li></ol></div><div class="spec-doc"><p>A request handler, specialized for Twirp.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mk_handler"><a href="#val-mk_handler" class="anchor"></a><code><span><span class="keyword">val</span> mk_handler : 
  <span><span><span>(<span class="type-var">'req</span>, <a href="../../pbrt_services/Pbrt_services/Value_mode/index.html#type-unary">Pbrt_services.Value_mode.unary</a>, <span class="type-var">'res</span>, <a href="../../pbrt_services/Pbrt_services/Value_mode/index.html#type-unary">Pbrt_services.Value_mode.unary</a>)</span>
    <a href="../../pbrt_services/Pbrt_services/Server/index.html#type-rpc">Pbrt_services.Server.rpc</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="type-var">'req</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'res</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-handler">handler</a></span></code></div><div class="spec-doc"><p>Create a handler.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-add_service"><a href="#val-add_service" class="anchor"></a><code><span><span class="keyword">val</span> add_service : 
  <span><span class="optlabel">?middlewares</span>:<span><a href="../../tiny_httpd/Tiny_httpd_core/Server/Middleware/index.html#type-t">Tiny_httpd.Middleware.t</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?prefix</span>:<span>string option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../tiny_httpd/Tiny_httpd/index.html#type-t">Tiny_httpd.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-handler">handler</a> <a href="../../pbrt_services/Pbrt_services/Server/index.html#type-t">Pbrt_services.Server.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p><code>add_service http_server service</code> adds all handlers of <code>service</code> to the given httpd.</p><p>As a reminder, a RPC &quot;foo&quot; under service &quot;bar&quot; is routed under <code>prefix/bar/foo</code> using the POST method. The body is either binary, alongside the header &quot;application/protobuf&quot;, or JSON, alongside the header &quot;application/json&quot;. Errors are always encoded as a JSON object and are indicated by a failing HTTP code (outside of <code>200…299</code> range).</p><p>RPCs that use streaming (on either the client or server side) will always return &quot;501 unimplemented&quot;, because twirp over http 1.1 does not support streaming.</p></div></div></div></body></html>
